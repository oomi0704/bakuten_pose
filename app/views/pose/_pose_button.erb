<html>
  <head>
    <title>pose detection</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection"></script>
    <script src="/javascripts/pose_direction.js"></script>
    <meta charset="UTF-8">
  </head>
  
  <body>
    <div id="container">
    
      <% if @user.stand_image.present? %>
        <%= image_tag @user.stand_image.url, id: 'img_stand', width: '500px', alt: 'Stand Image', crossorigin: 'anonymous' %>
      <% else %>
        <%= image_tag 'stand.jpeg', id: 'img_stand', width: '500px', alt: 'Stand Image', crossorigin: 'anonymous' %>
      <% end %>
      <canvas id="canvas_stand" ></canvas> 
      <%= render 'pose/pose_stand' %>
    </div>

     <div id="container">
      <% if @user.fly_image.present? %>
        <%= image_tag @user.fly_image.url, id: 'img_fly', width: '500px', alt: 'Fly Image', crossorigin: 'anonymous' %>
      <% else %>
        <%= image_tag 'fly.jpeg', id: 'img_fly', width: '500px', alt: 'Fly Image', crossorigin: 'anonymous' %>
      <% end %>
      <canvas id="canvas_fly" ></canvas> 
      <%= render 'pose/pose_fly' %>
    </div>

    <div id="container">
      <% if @user.land_image.present? %>
        <%= image_tag @user.land_image.url, id: 'img_land', width: '500px', alt: 'Land Image', crossorigin: 'anonymous' %>
      <% else %>
        <%= image_tag 'land.jpeg', id: 'img_land', width: '500px', alt: 'Land Image', crossorigin: 'anonymous' %>
      <% end %>
      <canvas id="canvas_land" ></canvas> 
      <%= render 'pose/pose_land' %>
    </div>

    <button id="start-button">診断開始</button>

    <script src="/javascripts/pose_direction.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const startButton = document.getElementById('start-button');
        if (startButton) {
          startButton.addEventListener('click', function() {
            startPoseDetection(); // pose_direction.js内の関数を呼び出す
          });
        }
      });
    </script>

  </body>
</html>
